<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <title>Bingo Speler</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<h1>ðŸŽ´ Bingo</h1>

<div>
  <button onclick="setTheme('dark')">ðŸŒ™ Dark</button>
  <button onclick="setTheme('neon')">âœ¨ Neon</button>
</div>

<h2 id="current">Wachten op nummerâ€¦</h2>

<div class="board" id="board"></div>
<h2 id="bingoText"></h2>

<audio id="ding" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg"></audio>

<script src="bingo.js"></script>
<script>
const hostId = new URLSearchParams(location.search).get("host");
const name = prompt("Wat is je naam?");
const peer = new Peer();
let conn;
const board = document.getElementById("board");
const cells = [];

createCard().forEach(n => {
  const d = document.createElement("div");
  d.className = "cell";
  d.textContent = n;

  d.onclick = () => {
    d.classList.toggle("marked");
    if (checkBingo(cells)) {
      document.getElementById("bingoText").innerText = "ðŸ† BINGO!";
      document.getElementById("bingoText").className = "bingo";
      conn.send({ type: "bingo", name });
    }
  };

  board.appendChild(d);
  cells.push(d);
});

peer.on("open", () => {
  conn = peer.connect(hostId);

  conn.on("data", msg => {
    if (msg.type === "number") {
      document.getElementById("current").innerText =
        "Nummer: " + msg.value;
      document.getElementById("ding").play();
    }

    if (msg.type === "reset") {
      location.reload();
    }
  });
});

function setTheme(theme) {
  document.body.className = theme;
}
</script>

</body>
</html>
